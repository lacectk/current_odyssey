[32m2025-01-07 16:55:16 +0000[0m - dagster - [34mDEBUG[0m - buoy_data_job - cf299749-3d75-4d23-9173-13b45b541cb7 - 818196 - LOGS_CAPTURED - Started capturing logs in process (pid: 818196).
[32m2025-01-07 16:55:16 +0000[0m - dagster - [34mDEBUG[0m - buoy_data_job - cf299749-3d75-4d23-9173-13b45b541cb7 - 818196 - raw_buoy_data - STEP_START - Started execution of step "raw_buoy_data".
[32m2025-01-07 16:55:16 +0000[0m - dagster - [34mINFO[0m - buoy_data_job - cf299749-3d75-4d23-9173-13b45b541cb7 - raw_buoy_data - Starting wave data collection
WARNING:  database "stations" has a collation version mismatch
DETAIL:  The database was created using collation version 2.38, but the operating system provides version 2.39.
HINT:  Rebuild all objects in this database that use the default collation and run ALTER DATABASE stations REFRESH COLLATION VERSION, or build PostgreSQL with the right library version.
[32m2025-01-07 16:55:16 +0000[0m - dagster - [34mINFO[0m - buoy_data_job - cf299749-3d75-4d23-9173-13b45b541cb7 - raw_buoy_data - Found 918 stations to process
INFO:src.backend.buoy_data.localized_wave:Starting wave data processing
WARNING:  database "stations" has a collation version mismatch
DETAIL:  The database was created using collation version 2.38, but the operating system provides version 2.39.
HINT:  Rebuild all objects in this database that use the default collation and run ALTER DATABASE stations REFRESH COLLATION VERSION, or build PostgreSQL with the right library version.
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 41047
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 41049
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 41052
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 41053
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 41056
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 41064
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 41065
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 41066
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 41067
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 41069
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 41070
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 41076
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 41082
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 41083
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 41108
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 41110
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 41112
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 41113
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 41114
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 41115
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 41117
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 41120
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 41122
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 41139
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 41159
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 42001
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 42002
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 42012
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 42013
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 42019
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 42020
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 42023
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 42026
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 42035
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 42036
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 42040
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 42055
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 42056
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 42057
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 42058
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 42060
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 42085
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 42091
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 42092
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 42095
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 42097
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 42098
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44007
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44008
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44009
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44011
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44013
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44014
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44020
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44025
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44027
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44029
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44030
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44032
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44033
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44034
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44041
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44042
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44043
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44056
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44058
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44062
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44063
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44064
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44072
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44073
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44078
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44079
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44085
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44086
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44087
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44088
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44089
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44090
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44091
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44095
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44097
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44098
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44099
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44100
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44137
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44139
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44258
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44489
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45001
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45002
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45003
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45004
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45005
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45006
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45007
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45008
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45012
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45013
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45022
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45023
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45024
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45025
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45026
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45027
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45029
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45132
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45135
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45136
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45137
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45139
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45140
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45142
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45143
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45147
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45148
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45149
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45151
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45152
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45154
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45159
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45161
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45162
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45163
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45164
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45165
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45170
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 44488
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45174
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45175
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45176
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45178
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45186
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45187
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45194
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45196
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45198
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45200
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45201
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45202
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45203
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45204
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45205
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45206
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45207
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45208
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45209
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45210
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45211
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45215
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45216
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45218
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 45219
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 46001
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 46005
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 46006
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 46011
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 46013
INFO:src.backend.buoy_data.localized_wave:Fetching wave data for station: 46014
ERROR:src.backend.buoy_data.localized_wave:Error processing wave data: (psycopg2.errors.UndefinedTable) relation "stations" does not exist
LINE 1: SELECT latitude, longitude FROM stations WHERE station_id = ...
                                        ^

[SQL: SELECT latitude, longitude FROM stations WHERE station_id = %(station_id)s]
[parameters: {'station_id': '46014'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
[32m2025-01-07 16:57:22 +0000[0m - dagster - [34mERROR[0m - [31mbuoy_data_job - cf299749-3d75-4d23-9173-13b45b541cb7 - raw_buoy_data - Error processing wave data: (psycopg2.errors.UndefinedTable) relation "stations" does not exist
LINE 1: SELECT latitude, longitude FROM stations WHERE station_id = ...
                                        ^

[SQL: SELECT latitude, longitude FROM stations WHERE station_id = %(station_id)s]
[parameters: {'station_id': '46014'}]
(Background on this error at: https://sqlalche.me/e/20/f405)[0m
[32m2025-01-07 16:57:22 +0000[0m - dagster - [34mERROR[0m - [31mbuoy_data_job - cf299749-3d75-4d23-9173-13b45b541cb7 - 818196 - raw_buoy_data - STEP_FAILURE - Execution of step "raw_buoy_data" failed.

dagster._core.errors.DagsterUnknownResourceError: Unknown resource `email_notification`. Specify `email_notification` as a required resource on the compute / config function that accessed it.

Stack Trace:
  File "/usr/local/google/home/lacectk/current_odyssey/venv/lib/python3.11/site-packages/dagster/_core/execution/plan/execute_plan.py", line 245, in dagster_event_sequence_for_step
    for step_event in check.generator(step_events):
  File "/usr/local/google/home/lacectk/current_odyssey/venv/lib/python3.11/site-packages/dagster/_core/execution/plan/execute_step.py", line 500, in core_dagster_event_sequence_for_step
    for user_event in _step_output_error_checked_user_event_sequence(
  File "/usr/local/google/home/lacectk/current_odyssey/venv/lib/python3.11/site-packages/dagster/_core/execution/plan/execute_step.py", line 183, in _step_output_error_checked_user_event_sequence
    for user_event in user_event_sequence:
  File "/usr/local/google/home/lacectk/current_odyssey/venv/lib/python3.11/site-packages/dagster/_core/execution/plan/execute_step.py", line 87, in _process_asset_results_to_events
    for user_event in user_event_sequence:
  File "/usr/local/google/home/lacectk/current_odyssey/venv/lib/python3.11/site-packages/dagster/_core/execution/plan/compute.py", line 193, in execute_core_compute
    for step_output in _yield_compute_results(step_context, inputs, compute_fn, compute_context):
  File "/usr/local/google/home/lacectk/current_odyssey/venv/lib/python3.11/site-packages/dagster/_core/execution/plan/compute.py", line 162, in _yield_compute_results
    for event in iterate_with_context(
  File "/usr/local/google/home/lacectk/current_odyssey/venv/lib/python3.11/site-packages/dagster/_utils/__init__.py", line 490, in iterate_with_context
    next_output = next(iterator)
                  ^^^^^^^^^^^^^^
  File "/usr/local/google/home/lacectk/current_odyssey/venv/lib/python3.11/site-packages/dagster/_core/execution/plan/compute.py", line 129, in gen_from_async_gen
    yield loop.run_until_complete(async_gen.__anext__())
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/usr/local/google/home/lacectk/current_odyssey/venv/lib/python3.11/site-packages/dagster/_core/execution/plan/compute_generator.py", line 101, in _coerce_async_op_to_async_gen
    result = await awaitable
             ^^^^^^^^^^^^^^^
  File "/usr/local/google/home/lacectk/current_odyssey/src/backend/dagster_break_analytics/assets/buoy_data_dag.py", line 94, in raw_buoy_data
    email_client = context.resources.email_notification.get_client()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/google/home/lacectk/current_odyssey/venv/lib/python3.11/site-packages/dagster/_core/definitions/scoped_resources_builder.py", line 29, in __getattr__
    raise DagsterUnknownResourceError(name)

The above exception occurred during handling of the following exception:
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedTable) relation "stations" does not exist
LINE 1: SELECT latitude, longitude FROM stations WHERE station_id = ...
                                        ^

[SQL: SELECT latitude, longitude FROM stations WHERE station_id = %(station_id)s]
[parameters: {'station_id': '46014'}]
(Background on this error at: https://sqlalche.me/e/20/f405)

Stack Trace:
  File "/usr/local/google/home/lacectk/current_odyssey/src/backend/dagster_break_analytics/assets/buoy_data_dag.py", line 37, in raw_buoy_data
    await processor.process_data()
  File "/usr/local/google/home/lacectk/current_odyssey/src/backend/buoy_data/localized_wave.py", line 226, in process_data
    await fetcher.fetch_stations_data()
  File "/usr/local/google/home/lacectk/current_odyssey/src/backend/buoy_data/localized_wave.py", line 61, in fetch_stations_data
    await self._insert_localized_wave_data_into_db(
  File "/usr/local/google/home/lacectk/current_odyssey/src/backend/buoy_data/localized_wave.py", line 180, in _insert_localized_wave_data_into_db
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "/usr/local/google/home/lacectk/current_odyssey/venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "/usr/local/google/home/lacectk/current_odyssey/venv/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/google/home/lacectk/current_odyssey/venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/google/home/lacectk/current_odyssey/venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/google/home/lacectk/current_odyssey/venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/google/home/lacectk/current_odyssey/venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/google/home/lacectk/current_odyssey/venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/google/home/lacectk/current_odyssey/venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 941, in do_execute
    cursor.execute(statement, parameters)

The above exception was caused by the following exception:
psycopg2.errors.UndefinedTable: relation "stations" does not exist
LINE 1: SELECT latitude, longitude FROM stations WHERE station_id = ...
                                        ^


Stack Trace:
  File "/usr/local/google/home/lacectk/current_odyssey/venv/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/google/home/lacectk/current_odyssey/venv/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
[0m
